page2 <- read_html(table_comment_clean2)
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
Attendance <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[8]/td"))
game_info_temp <- data.frame(
Won_toss,
Roof,
Surface,
Duration,
Attendance,
Vegas_line,
Over_under)
game_info_temp$urls<-rep(i,nrow(game_info_temp))
game_info_df<-rbind(game_info_df, game_info_temp)
}
# games_df
load("officials_games.rda")
game_info_df <- data.frame(Won_toss = character(0),
Roof = character(0),
Surface = character(0),
Duration = character(0),
Attendance = character(0),
Weather = character(0),
Vegas_line = character(0),
Over_under = character(0),
urls = character(0))
# Removing duplicate games
urls_unique <- unique(games_df$gameurl)
urls5 <- urls_unique[1:5]
for (i in urls5) {
print(i)
url<-GET(i)
Sys.sleep(5)
page<-read_html(url)
table_comment <- xml_find_all(page, "//div[@id='all_game_info']//comment()")
table_comment_clean<- gsub("<!--" , "", table_comment)
table_comment_clean2 <- gsub("-->", "", table_comment_clean)
page2 <- read_html(table_comment_clean2)
rows <- xml_find_all(page2,"//table[@id='game_info']//tr")
if (length(rows)==8) {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
Attendance <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Weather <- NA
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[8]/td"))
}
else {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
Attendance <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Weather <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[8]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[9]/td"))
}
game_info_temp <- data.frame(
Won_toss,
Roof,
Surface,
Duration,
Attendance,
Weather,
Vegas_line,
Over_under)
game_info_temp$urls<-rep(i,nrow(game_info_temp))
game_info_df<-rbind(game_info_df, game_info_temp)
}
View(game_info_df)
View(game_info_df)
View(game_info_df)
urls5 <- urls_unique[1:5]
for (i in urls5) {
print(i)
#  url<-GET(i)
Sys.sleep(5)
page<-read_html(i)
table_comment <- xml_find_all(page, "//div[@id='all_game_info']//comment()")
table_comment_clean<- gsub("<!--" , "", table_comment)
table_comment_clean2 <- gsub("-->", "", table_comment_clean)
page2 <- read_html(table_comment_clean2)
rows <- xml_find_all(page2,"//table[@id='game_info']//tr")
if (length(rows)==8) {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
Attendance <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Weather <- NA
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[8]/td"))
}
else {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
Attendance <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Weather <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[8]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[9]/td"))
}
game_info_temp <- data.frame(
Won_toss,
Roof,
Surface,
Duration,
Attendance,
Weather,
Vegas_line,
Over_under)
game_info_temp$urls<-rep(i,nrow(game_info_temp))
game_info_df<-rbind(game_info_df, game_info_temp)
}
rm(list=ls())
library(dplyr)
library(reshape2)
load("officials_overview.rda")
load("officials_stats.rda")
load("officials_games.rda")
View(stats_df)
View(officials_df)
#fixing columns
start_year <- strsplit(officials_df$years, "-")
View(start_year)
?sapply
#fixing columns
start_year <- sapply(strsplit(officials_df$years, "-"), "[[", 1 )
end_year <- sapply(strsplit(officials_df$years, "-"), "[[", 2 )
#fixing columns
officials_df$start_year <- sapply(strsplit(officials_df$years, "-"), "[[", 1 )
officials_df$end_year <- sapply(strsplit(officials_df$years, "-"), "[[", 2 )
View(officials_df)
#remove years col
officials_df <- select(officials_df, -years)
View(officials_df)
View(stats_df)
stats_df$home_penalties <- gsub("%", "", stats_df$home_penalties)
stats_df$home_wp <- gsub("%", "", stats_df$wp)
View(stats_df)
stats_df$home_wp <- gsub("%", "", stats_df$home_wp)
stats_df$home_wp <- stats_df$home_wp *100
#stats_df$home_penalties <-
stats_df$home_wp <- as.numeric(stats_df$home_wp)
#################################################################
stats_df$home_wp <- stats_df$home_wp * 100
stats_df$playoff_games <- gsub("*", "", stats_df$playoff_games, fixed = TRUE)
#use gsub to get rid of %
jobs <- strsplit(stats_df$positions, ",")
stats_df$position <- character(stats_df$position)
stats_df$position <- as.character(stats_df$position)
#use gsub to get rid of %
jobs <- strsplit(stats_df$positions, ",")
rm(list=ls())
library(dplyr)
library(reshape2)
load("officials_overview.rda")
load("officials_stats.rda")
load("officials_games.rda")
stats_df$position <- as.character(stats_df$position)
#use gsub to get rid of %
jobs <- strsplit(stats_df$positions, ",")
#use gsub to get rid of %
jobs <- strsplit(stats_df$position, ",")
View(jobs)
job1 <- character(0)
job2 <- character(0)
for (i in jobs) {
# job1 <- c(job1, i[1])
print(i[1])
}
job1 <- c(job1, i[1])
if (length(i) == 2){
job2 <- c(job2, i[2])
}
else {
job2 <- c(job2, NA)
}
#fixing position col
jobs <- strsplit(stats_df$position, ",")
job1 <- character(0)
job2 <- character(0)
for (i in jobs) {
job1 <- c(job1, i[1])
if (length(i) == 2){
job2 <- c(job2, i[2])
}
else {
job2 <- c(job2, NA)
}
}
job2
stats_df$position1 <- job1
stats_df$position2 <- job2
View(stats_df)
View(officials_df)
View(games_df)
#changing column types
games_df$Date <- as.Date(games_df$Date, format = "%B %d, %Y")
View(games_df)
# games_df
load("officials_games.rda")
game_info_df <- data.frame(Won_toss = character(0),
Roof = character(0),
Surface = character(0),
Duration = character(0),
Attendance = character(0),
Weather = character(0),
Vegas_line = character(0),
Over_under = character(0),
urls = character(0))
# Removing duplicate games
urls_unique <- unique(games_df$gameurl)
urls5 <- urls_unique[1:5]
for (i in urls5) {
print(i)
url<-GET(i)
Sys.sleep(5)
page<-read_html(url)
table_comment <- xml_find_all(page, "//div[@id='all_game_info']//comment()")
table_comment_clean<- gsub("<!--" , "", table_comment)
table_comment_clean2 <- gsub("-->", "", table_comment_clean)
page2 <- read_html(table_comment_clean2)
rows <- xml_find_all(page2,"//table[@id='game_info']//tr")
if (length(rows)==8) {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
Attendance <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Weather <- NA
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[8]/td"))
}
else {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
Attendance <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Weather <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[8]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[9]/td"))
}
game_info_temp <- data.frame(
Won_toss,
Roof,
Surface,
Duration,
Attendance,
Weather,
Vegas_line,
Over_under)
game_info_temp$urls<-rep(i,nrow(game_info_temp))
game_info_df<-rbind(game_info_df, game_info_temp)
}
rm(list=ls())
# Load packages
library(xml2)
library(httr)
# officials_df
load("officials_overview.rda")
# games_df
load("officials_games.rda")
game_info_df <- data.frame(Won_toss = character(0),
Roof = character(0),
Surface = character(0),
Duration = character(0),
Attendance = character(0),
Weather = character(0),
Vegas_line = character(0),
Over_under = character(0),
urls = character(0))
# Removing duplicate games
urls_unique <- unique(games_df$gameurl)
urls5 <- urls_unique[1:5]
for (i in urls5) {
print(i)
url<-GET(i)
Sys.sleep(5)
page<-read_html(url)
table_comment <- xml_find_all(page, "//div[@id='all_game_info']//comment()")
table_comment_clean<- gsub("<!--" , "", table_comment)
table_comment_clean2 <- gsub("-->", "", table_comment_clean)
page2 <- read_html(table_comment_clean2)
rows <- xml_find_all(page2,"//table[@id='game_info']//tr")
if (length(rows)==8) {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
Attendance <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Weather <- NA
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[8]/td"))
}
else {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
Attendance <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Weather <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[8]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[9]/td"))
}
game_info_temp <- data.frame(
Won_toss,
Roof,
Surface,
Duration,
Attendance,
Weather,
Vegas_line,
Over_under)
game_info_temp$urls<-rep(i,nrow(game_info_temp))
game_info_df<-rbind(game_info_df, game_info_temp)
}
View(game_info_df)
for (i in urls_unique) {
print(i)
url<-GET(i)
Sys.sleep(5)
page<-read_html(url)
table_comment <- xml_find_all(page, "//div[@id='all_game_info']//comment()")
table_comment_clean<- gsub("<!--" , "", table_comment)
table_comment_clean2 <- gsub("-->", "", table_comment_clean)
page2 <- read_html(table_comment_clean2)
rows <- xml_find_all(page2,"//table[@id='game_info']//tr")
if (length(rows)==8) {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
Attendance <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Weather <- NA
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[8]/td"))
}
else {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
Attendance <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Weather <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[8]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[9]/td"))
}
game_info_temp <- data.frame(
Won_toss,
Roof,
Surface,
Duration,
Attendance,
Weather,
Vegas_line,
Over_under)
game_info_temp$urls<-rep(i,nrow(game_info_temp))
game_info_df<-rbind(game_info_df, game_info_temp)
}
rm(list=ls())
# Load packages
library(xml2)
library(httr)
# officials_df
load("officials_overview.rda")
# games_df
load("officials_games.rda")
game_info_df <- data.frame(Won_toss = character(0),
Roof = character(0),
Surface = character(0),
Duration = character(0),
Attendance = character(0),
Weather = character(0),
Vegas_line = character(0),
Over_under = character(0),
urls = character(0))
# Removing duplicate games
urls_unique <- unique(games_df$gameurl)
for (i in urls_unique) {
print(i)
url<-GET(i)
Sys.sleep(5)
page<-read_html(url)
table_comment <- xml_find_all(page, "//div[@id='all_game_info']//comment()")
table_comment_clean<- gsub("<!--" , "", table_comment)
table_comment_clean2 <- gsub("-->", "", table_comment_clean)
page2 <- read_html(table_comment_clean2)
rows <- xml_find_all(page2,"//table[@id='game_info']//tr")
if (length(rows)==7) {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
attendance <- NA
Weather <- NA
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
}
else if (length(rows)==8) {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
Attendance <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Weather <- NA
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[8]/td"))
}
else {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
Attendance <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Weather <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[8]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[9]/td"))
}
game_info_temp <- data.frame(
Won_toss,
Roof,
Surface,
Duration,
Attendance,
Weather,
Vegas_line,
Over_under)
game_info_temp$urls<-rep(i,nrow(game_info_temp))
game_info_df<-rbind(game_info_df, game_info_temp)
}
View(game_info_df)
View(game_info_df)
u <- unique(game_info_df)
View(game_info_df)
View(game_info_df)
urls_unique
urls_unique[3002]
urls_unique[3001]
urls_secondhalf <- urls_unique[3002:5646]
for (i in urls_secondhalf) {
print(i)
url<-GET(i)
Sys.sleep(5)
page<-read_html(url)
table_comment <- xml_find_all(page, "//div[@id='all_game_info']//comment()")
table_comment_clean<- gsub("<!--" , "", table_comment)
table_comment_clean2 <- gsub("-->", "", table_comment_clean)
page2 <- read_html(table_comment_clean2)
rows <- xml_find_all(page2,"//table[@id='game_info']//tr")
if (length(rows)==6) {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- NA
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
attendance <- NA
Weather <- NA
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
}
else if (length(rows)==7) {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
attendance <- NA
Weather <- NA
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
}
else if (length(rows)==8) {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
Attendance <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Weather <- NA
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[8]/td"))
}
else {
Won_toss<-xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[2]/td"))
Roof <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[3]/td"))
Surface <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[4]/td"))
Duration <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[5]/td"))
Attendance <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[6]/td"))
Weather <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[7]/td"))
Vegas_line <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[8]/td"))
Over_under <- xml_text(xml_find_all(page2, "//table[@id='game_info']//tr[9]/td"))
}
game_info_temp <- data.frame(
Won_toss,
Roof,
Surface,
Duration,
Attendance,
Weather,
Vegas_line,
Over_under)
game_info_temp$urls<-rep(i,nrow(game_info_temp))
game_info_df<-rbind(game_info_df, game_info_temp)
}
save(game_info_df, file="game_info.rda")
View(game_info_df)
